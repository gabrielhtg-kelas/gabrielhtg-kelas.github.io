<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="style.css" />
    <link rel="stylesheet" href="form1.css" />
    <link
      rel="stylesheet"
      href="assets/vendor/bootstrap-5.2.3-dist/css/bootstrap.min.css"
    />
    <title>Form Gabungan</title>
  </head>
  <body>
    <div
      class="d-flex justify-content-center gap-5 flex-wrap min-vh-100 align-items-center"
    >
      <!-- form 1 -->
      <div class="kotak-form">
        <h1>Form Validasi</h1>
        <h3>Validasi setelah menekan tombol Submit</h3>
        <form id="myForm" onsubmit="return validateForm()">
          <div class="mb-15">
            <label for="nama">Nama:</label>
            <input type="text" id="nama" name="nama" />
            <span id="namaError" class="error"></span>
          </div>

          <div class="mb-15">
            <label for="email">Email:</label>
            <input type="email" id="email" name="email" />
            <span id="emailError" class="error"></span>
          </div>

          <div class="mb-15">
            <label for="role">Role:</label>
            <select id="role" name="role">
              <option value="">~Pilih Role~</option>
              <option>Pengajar</option>
              <option>Pelajar</option>
            </select>
            <span id="roleError" class="error"></span>
          </div>

          <div class="mb-15">
            <input type="submit" value="Submit" />
          </div>
        </form>

        <script>
          function validateForm() {
            let status = true;

            var nama = document.getElementById("nama").value.trim();
            var email = document.getElementById("email").value.trim();
            var role = document.getElementById("role").value.trim();

            var namaError = document.getElementById("namaError");
            var emailError = document.getElementById("emailError");
            var roleError = document.getElementById("roleError");

            namaError.innerHTML = "";
            emailError.innerHTML = "";
            roleError.innerHTML = "";

            if (nama === "") {
              namaError.innerHTML = "Nama harus diisi!";
              status = false;
            } else if (nama.length < 8) {
              namaError.innerHTML = "Panjang nama minimal 8 karakter!";
              status = false;
            } else {
              const regex = /^[A-Za-z\s]*$/;
              if (!regex.test(nama)) {
                namaError.innerHTML =
                  "Nama hanya boleh terdiri dari huruf alfabet dan spasi!";
                status = false;
              }
            }

            if (email === "") {
              emailError.innerHTML = "Email harus diisi!";
              status = false;
            } else {
              const emailPattern =
                /^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/;

              if (!emailPattern.test(email)) {
                emailError.innerHTML = "Format email tidak valid!";
                status = false;
              }
            }

            if (role === "") {
              roleError.innerHTML = "Role harus dipilih!";
              status = false;
            }

            return status;
          }
        </script>
      </div>

      <!-- Form 2 -->
      <div class="kotak-form">
        <div class="mx-auto mt-3" style="max-width: 400px">
          <h1 class="text-center mb-0">Form Validasi</h1>
          <h3 class="text-center text-muted">Validasi dengan Toggle Class</h3>

          <div class="card">
            <div class="card-body">
              <form
                id="myForm"
                class="needs-validation"
                onsubmit="return validateForm()"
              >
                <div class="mb-3">
                  <label class="form-label" for="nama">Nama</label>
                  <input
                    class="form-control"
                    type="text"
                    id="nama"
                    name="nama"
                  />
                  <div class="invalid-feedback" id="namaError">Error</div>
                </div>

                <div class="mb-3">
                  <label class="form-label" for="email">Email</label>
                  <input
                    class="form-control"
                    type="email"
                    id="email"
                    name="email"
                  />
                  <div class="invalid-feedback" id="emailError">Error</div>
                </div>

                <div class="mb-3">
                  <label for="role">Role</label>
                  <select class="form-select" id="role" name="role">
                    <option value="">~Pilih Role~</option>
                    <option>Pengajar</option>
                    <option>Pelajar</option>
                  </select>
                  <div class="invalid-feedback" id="roleError">Error</div>
                </div>

                <div class="mb-3 text-end">
                  <input class="btn btn-primary" type="submit" value="Submit" />
                </div>
              </form>
            </div>
          </div>
        </div>

        <script>
          function validateForm() {
            let status = {
              nama: true,
              email: true,
              role: true,
            };

            let elmntNama = document.getElementById("nama");
            let elmntEmail = document.getElementById("email");
            let elmntRole = document.getElementById("role");

            elmntNama.classList.remove("is-invalid");
            elmntEmail.classList.remove("is-invalid");
            elmntRole.classList.remove("is-invalid");

            var nama = elmntNama.value.trim();
            var email = elmntEmail.value.trim();
            var role = elmntRole.value.trim();

            var namaError = document.getElementById("namaError");
            var emailError = document.getElementById("emailError");
            var roleError = document.getElementById("roleError");

            namaError.innerHTML = "";
            emailError.innerHTML = "";
            roleError.innerHTML = "";

            if (nama === "") {
              namaError.innerHTML = "Nama harus diisi!";
              status.nama = false;
            } else if (nama.length < 8) {
              namaError.innerHTML = "Panjang nama minimal 8 karakter!";
              status.nama = false;
            } else {
              const regex = /^[A-Za-z\s]*$/;
              if (!regex.test(nama)) {
                namaError.innerHTML =
                  "Nama hanya boleh terdiri dari huruf alfabet dan spasi!";
                status.nama = false;
              }
            }

            if (email === "") {
              emailError.innerHTML = "Email harus diisi!";
              status.email = false;
            } else {
              const emailPattern =
                /^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/;

              if (!emailPattern.test(email)) {
                emailError.innerHTML = "Format email tidak valid!";
                status.email = false;
              }
            }

            if (role === "") {
              roleError.innerHTML = "Role harus dipilih!";
              status.role = false;
            }

            if (!status.nama) {
              elmntNama.classList.add("is-invalid");
            }

            if (!status.email) {
              elmntEmail.classList.add("is-invalid");
            }

            if (!status.role) {
              elmntRole.classList.add("is-invalid");
            }

            console.log(status);
            return status.nama && status.email && status.role;
          }
        </script>
      </div>

      <!-- Form 3 -->
      <div class="kotak-form">
        <div class="mx-auto mt-3" style="max-width: 400px">
          <h1 class="text-center mb-0">Form Validasi</h1>
          <h3 class="text-center text-muted">Validasi secara Realtime</h3>

          <div class="card">
            <div class="card-body">
              <form
                id="myForm"
                class="needs-validation"
                onsubmit="return validateForm()"
              >
                <div class="mb-3">
                  <label class="form-label" for="inputUsername">Username</label>
                  <input
                    oninput="validateUsername(this)"
                    class="form-control"
                    type="text"
                    id="inputUsername"
                    name="username"
                    autocomplete="username"
                  />
                  <div class="invalid-feedback" id="usernameErr"></div>
                </div>

                <div class="mb-3">
                  <label class="form-label" for="inputPassword">Password</label>
                  <input
                    oninput="validatePassword(this)"
                    class="form-control"
                    type="password"
                    id="inputPassword"
                    name="password"
                    autocomplete="current-password"
                  />
                  <ul id="passwordInfo" class="ms-1 list-unstyled">
                    <li>
                      <span class="text-danger">
                        &#10005; panjang minimal 8 karakter
                      </span>
                    </li>
                    <li>
                      <span class="text-danger">
                        &#10005; terdapat huruf kapital
                      </span>
                    </li>
                    <li>
                      <span class="text-danger">
                        &#10005; terdapat huruf kecil
                      </span>
                    </li>
                    <li>
                      <span class="text-danger"> &#10005; terdapat angka </span>
                    </li>
                    <li>
                      <span class="text-danger">
                        &#10005; terdapat karakter spesial
                      </span>
                    </li>
                  </ul>
                </div>

                <div class="mb-3 text-end">
                  <input class="btn btn-primary" type="submit" value="Submit" />
                </div>
              </form>
            </div>
          </div>
        </div>

        <script>
          function validateUsername(targetElmnt) {
            let status = true;
            const elmntErr = document.getElementById("usernameErr");
            elmntErr.innerHTML = "";

            if (targetElmnt.value.trim() === "") {
              elmntErr.innerHTML = "Username tidak boleh kosong!";
              status = false;
            } else if (targetElmnt.value.length != 8) {
              elmntErr.innerHTML = "Panjang username harus 8 karakter!";
              status = false;
            } else {
              // example: ifs18005
              const usernamePattern = /(ifs[1-9][0-9]{4})$/gm;

              if (!usernamePattern.test(targetElmnt.value)) {
                elmntErr.innerHTML =
                  "Format username tidak mewakili prodi informatika.";
                status = false;
              } else if (
                targetElmnt.value.slice(3, 5) >
                new Date().getFullYear().toString().slice(2, 4)
              ) {
                elmntErr.innerHTML =
                  "Username dengan angkatan ini belum tersedia.";
                status = false;
              }
            }

            if (status) {
              targetElmnt.classList.add("is-valid");
              targetElmnt.classList.remove("is-invalid");
            } else {
              targetElmnt.classList.add("is-invalid");
              targetElmnt.classList.remove("is-valid");
            }

            return status;
          }

          function validatePassword(targetElmnt) {
            let status = true;
            const elmntPasswordInfo = document.getElementById("passwordInfo");
            const listItems = elmntPasswordInfo.querySelectorAll("li");

            if (targetElmnt.value.length < 8) {
              listItems[0].innerHTML = `<span class="text-danger">
            &#10005; panjang minimal 8 karakter
            </span>`;
              status = false;
            } else {
              listItems[0].innerHTML = `<span class="text-success">
            &#10003; panjang minimal 8 karakter
            </span>`;
            }

            if (!/[A-Z]/.test(targetElmnt.value)) {
              listItems[1].innerHTML = `<span class="text-danger">
            &#10005; terdapat huruf kapital
            </span>`;
              status = false;
            } else {
              listItems[1].innerHTML = `<span class="text-success">
            &#10003; terdapat huruf kapital
            </span>`;
            }

            if (!/[a-z]/.test(targetElmnt.value)) {
              listItems[2].innerHTML = `<span class="text-danger">
            &#10005; terdapat huruf kecil
            </span>`;
              status = false;
            } else {
              listItems[2].innerHTML = `<span class="text-success">
            &#10003; terdapat huruf kecil
            </span>`;
            }

            if (!/[0-9]/.test(targetElmnt.value)) {
              listItems[3].innerHTML = `<span class="text-danger">
            &#10005; terdapat angka
            </span>`;
              status = false;
            } else {
              listItems[3].innerHTML = `<span class="text-success">
            &#10003; terdapat angka
            </span>`;
            }

            if (!/[!@#$%^&*()_+{}\[\]:;<>,.?~\\-]/.test(targetElmnt.value)) {
              listItems[4].innerHTML = `<span class="text-danger">
            &#10005; terdapat karakter spesial
            </span>`;
              status = false;
            } else {
              listItems[4].innerHTML = `<span class="text-success">
            &#10003; terdapat karakter spesial
            </span>`;
            }

            if (status) {
              targetElmnt.classList.add("is-valid");
              targetElmnt.classList.remove("is-invalid");
            } else {
              targetElmnt.classList.add("is-invalid");
              targetElmnt.classList.remove("is-valid");
            }

            return status;
          }

          function validateForm() {
            const elmntUsername = document.getElementById("inputUsername");
            const elmntPassword = document.getElementById("inputPassword");

            return (
              validateUsername(elmntUsername) && validatePassword(elmntPassword)
            );
          }
        </script>
      </div>
    </div>
  </body>
</html>
